<html>
  <head>
    <title>Template Test</title>
    
    <script src="http://www.google.com/jsapi"></script>
    <script>google.load("jquery", "1");</script>
    <script src="jtple.js" type="text/javascript" charset="utf-8"></script>
    <link rel="stylesheet" href="index.css" type="text/css" media="screen" title="no title" charset="utf-8">
    
    <script>
      $(document).ready(function() {
        var template = new myEdu.util.tplManager();
        
        $('#submit').click(function() {
          // Just grab the info from the form
          var title = $('#title').val();
          var comment = $('#comment').val();
          var href = $('#href').val();
          var link = $('#link').val();
          var image = $('#image').val();
          var website, user_image;
          
          // If they passed both link text and an href then create the 
          // data structure for a link template
          if (link && href) { 
            website = { 'link': { 'href': href, 'value': link } };
          }
          else {
            website = null;
          }
          
          // If they passed an image src then create the structure for the 
          // image template
          if (image) {
            user_image = { 'image': { 'src': image } };
          }
          else {
            user_image = null;
          }
          
          // Create a new comment.  If website or user_image are null it won't
          // append those templates.
          var newComment = template.getNew('comment', {
              'title': title, 
              'comment': comment, 
              'website': website, 
              'user_image': user_image 
          });
          
          // Append the comment and show it.
          newComment.appendTo('#comments').fadeIn();
        });
        
        $('.add-image-button').live('click', function() {
            var parent_id = $(this).parents('.tpl').attr('id');
            
            var parent = template.get(parent_id);
            var src = $('.additional-image', parent.node).val();
            
            parent.addTpl('user_image', {'image': {'src': src } });
        });
      });
    </script>
  </head>
  <body>
    
    <div id="comments"></div>
    
    <form id="add-comment">
    
      <input type="text" name="title" id="title" /><br />
      <textarea name="comment" rows="8" cols="40" id="comment"></textarea><br />
      
      Website Name: <input type="text" name="link" id="link" /><br />
      Website URL: <input type="text" name="href" id="href" /><br /> 
      User Image: <input type="text" name="image" id="image"><br />
      
      <input type="button" name="submit" value="Submit" id="submit" />
    
    </form>
    
    http://mashable.com/wp-content/uploads/2008/01/stallman.png
    
    <!-- Templates -->
    <div style="display: none">
      <div class="tpl comment" name="comment">
        Title: <span class="var" name="title"></span><br />
        Comment: <br />
        <span class="var" name="comment"></span>
        
        <div class="tpl" name="website">
          Website: <a href='' class="var" name="link"></a>
        </div>
        
        <div class="tpl" name="user_image">
          <img src="" class="var user-image" name="image" />
        </div>
        
        <br />
        <h3>Add another image to this template</h3>
        <input type='text' name='additional-image' class='additional-image' />
        <input type="button" name="add-image" value="Submit" class='add-image-button' />
    </div>
    <!-- End Templates -->
    
  </body>
</html>